# -*- coding: utf-8 -*-
"""EDA-Only_.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/12YI1jgLp2kxesq3UbDSx6CVvJMxfSuxl
"""

# Commented out IPython magic to ensure Python compatibility.
# Import necessary libraries for EDA
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

# Enable inline plotting for Jupyter/Colab notebooks
# %matplotlib inline

# Load the dataset
file_path = "google_review_ratings.csv"  # Update the path if needed
df = pd.read_csv(file_path)

# Drop any unnamed columns
df.drop(columns=[col for col in df.columns if "Unnamed" in col], errors="ignore", inplace=True)

print("Dropped Unnamed Columns!\n")
print("Current Column Names Before Renaming:\n", df.columns)

# Define new column names as per the given sequence
new_column_names = [
    "userid", "churches", "resorts", "beaches", "parks", "theatres", "museums", "malls", "zoos",
    "restaurants", "pubs/bars", "local services", "burger/pizza shops", "hotels/other lodgings",
    "juice bars", "art galleries", "dance clubs", "swimming pools", "gyms", "bakeries",
    "beauty & spas", "cafes", "view points", "monuments", "gardens"
]

# Rename the columns
df.columns = new_column_names

print("Columns successfully renamed!\n")
print("Updated Column Names:\n", df.columns)
print("\n First 5 Rows of the Dataset:\n")
display(df.head())  # Display first few rows to verify changes

# Display basic dataset info
print("\n Dataset Overview:\n")
print(df.info())

# Check for missing values
print("\n Missing Values in Each Column:\n")
print(df.isnull().sum())

# Display first 5 rows for visual inspection
print("\n First 5 Rows of the Dataset:\n")
display(df.head())

# Display summary statistics
print("\nStatistical Summary of Ratings:\n")
display(df.describe())

# Set figure size
plt.figure(figsize=(15, 6))

# Plot histograms for each category
df.iloc[:, 1:].hist(figsize=(15, 12), bins=20, color='skyblue', edgecolor='black')
plt.suptitle("Distribution of Ratings for Each Category", fontsize=16)
plt.show()

# Compute correlation matrix
plt.figure(figsize=(12, 10))

# Convert relevant columns to numeric, handling errors
for col in df.columns[1:]:  # Iterate through columns from index 1 onwards
    try:
        df[col] = pd.to_numeric(df[col], errors='coerce')  # errors='coerce' will handle errors and replace invalid parsing with NaN
    except ValueError as e:
        print(f"Error converting column '{col}': {e}")  # Print error message

corr_matrix = df.iloc[:, 1:].corr()

# Plot heatmap
sns.heatmap(corr_matrix, annot=True, fmt=".2f", cmap='coolwarm', square=True)
plt.title("Correlation Heatmap of Ratings")
plt.show()

# Boxplot for all rating categories
plt.figure(figsize=(15, 6))
sns.boxplot(data=df.iloc[:, 1:], palette="coolwarm")
plt.xticks(rotation=90)  # Rotate x-axis labels for better readability
plt.title("Boxplot of Ratings for Each Category (Outliers Detection)")
plt.show()

# Violin plots to show rating distribution
plt.figure(figsize=(15, 6))
sns.violinplot(data=df.iloc[:, 1:], palette="coolwarm", inner="quartile")
plt.xticks(rotation=90)
plt.title("Violin Plot of Ratings Distribution")
plt.show()

